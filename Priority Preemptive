#include <stdio.h>
#include <stdlib.h>
typedef struct process
{
    int ID, AT, BT, CT, WT, TT, PRI;
    int status;
    int remainingTime;
} pro;

pro P[10];

int n;
void AT_Sorting()
{
    struct process temp;
    int i, j;
    for (i = 0; i < n - 1; i++)
    {
        for (j = i + 1; j < n; j++)
        {
            if (P[i].AT > P[j].AT)
            {
                temp = P[i];
                P[i] = P[j];
                P[j] = temp;
            }
        }
    }
}

void main()
{
    int i, tim = 0, BT = 0, cmp = 0,rep=0;
    float wait_time = 0, TT = 0, average_WT, average_TT;
    printf("\nEnter Total Number of Processes:\t");
    scanf("%d", &n);

   
    for (i = 0; i < n; i++)
    {
        printf("\nEnter Details For Process[%d]:\n", (i + 1));
        P[i].ID = (i + 1);
        printf("Enter Arrival Time:\t");
        scanf("%d", &P[i].AT);
        printf("Enter Burst Time:\t");
        scanf("%d", &P[i].BT);
        printf("Enter PRI:\t");
        scanf("%d", &P[i].PRI);
        P[i].status = 0;
        P[i].remainingTime = P[i].BT;
        BT = BT + P[i].BT;
    }

    AT_Sorting();
    P[9].PRI = -9999;
   
    printf("P%d(%d)\t",P[0].ID,0);
    while (cmp < n)
    {
        int HPRI = 9;
        for (i = 0; i < n; i++)
        {
            if (P[i].AT <= tim &&
                P[i].status != 1 &&
                P[i].PRI > P[HPRI].PRI)
            {
                HPRI = i;
            }
        }
       
        if(rep!=HPRI) printf("|P%d(%d)",P[HPRI].ID,tim);
        rep=HPRI;
       
        P[HPRI].remainingTime--;

               
        if (P[HPRI].remainingTime == 0)
         {
            cmp++;
            P[HPRI].CT = tim + 1;
            P[HPRI].WT = P[HPRI].CT - P[HPRI].AT - P[HPRI].BT;
            P[HPRI].TT = P[HPRI].CT - P[HPRI].AT;
            P[HPRI].status = 1;
            wait_time = wait_time + P[HPRI].WT;
            TT = TT + P[HPRI].TT;
           
        }

        tim++;
    }

    printf("\nProcess Name\tArrival Time\tBurst Time\tPRI\tWaiting Time\tTurnaround Time\n");

    for(int i=0;i<n;i++)
    {
    printf("%d\t\t%d\t\t%d\t\t%d\t\t%d\t\t%d\n", P[i].ID, P[i].AT, P[i].BT, P[i].PRI, P[i].WT, P[i].TT);
    }
   
    average_WT = wait_time / n;
    average_TT = TT / n;
    printf("\nAverage waiting time:\t%f\n", average_WT);
    printf("Average Turnaround Time:\t%f\n", average_TT);

    printf("\n");
   
}
